/* Worn card overlay effect (toggleable add-on). */

/* Hidden cards: full worn treatment only for compatible decks. */
body.deck-red .card.hidden,
body.deck-blue .card.hidden,
body.deck-green .card.hidden,
body.deck-water .card.hidden,
body.deck-sun .card.hidden {
    background:
        linear-gradient(135deg, rgba(255, 255, 255, 0.08) 0%, transparent 35%),
        radial-gradient(circle at 22% 32%, rgba(0, 0, 0, 0.25) 0%, transparent 42%),
        radial-gradient(circle at 80% 68%, rgba(0, 0, 0, 0.2) 0%, transparent 48%),
        radial-gradient(circle at 55% 50%, rgba(255, 255, 255, 0.08) 0%, transparent 38%),
        var(--card-back-bg);
    background-size: auto, auto, auto, auto, var(--card-back-bg-size, auto);
    background-position: 0 0, 0 0, 0 0, 0 0, var(--card-back-bg-position, center);
    background-repeat: no-repeat, repeat, repeat, no-repeat, no-repeat;
    border: 2px solid var(--card-back-accent);
    box-shadow: inset 0 0 18px rgba(90, 70, 45, 0.35), 0 0 6px rgba(0, 0, 0, 0.35);
}

body.deck-red .card.hidden::before,
body.deck-blue .card.hidden::before,
body.deck-green .card.hidden::before,
body.deck-water .card.hidden::before,
body.deck-sun .card.hidden::before {
    content: "";
    position: absolute;
    inset: 0;
    background:
        radial-gradient(circle at var(--wear-scuff-x, 28%) var(--wear-scuff-y, 30%), rgba(255, 255, 255, 0.08) 0%, transparent 48%),
        radial-gradient(circle at var(--wear-scuff2-x, 72%) var(--wear-scuff2-y, 68%), rgba(40, 30, 20, 0.22) 0%, transparent 55%),
        linear-gradient(var(--wear-scratch-angle, 25deg),
            rgba(40, 30, 20, 0.2) 0,
            rgba(40, 30, 20, 0.2) 1px,
            transparent 2px),
        linear-gradient(var(--wear-scratch-angle-2, -25deg),
            rgba(255, 255, 255, 0.08) 0,
            rgba(255, 255, 255, 0.08) 1px,
            transparent 2px);
    pointer-events: none;
    mix-blend-mode: multiply;
}

/* Hidden cards for decks with custom back art: overlay only. */
body[class*="deck-"] .card.hidden::after {
    content: "";
    position: absolute;
    inset: 0;
    pointer-events: none;
    background:
        radial-gradient(circle at var(--wear-scuff-x, 28%) var(--wear-scuff-y, 30%), rgba(255, 255, 255, 0.08) 0%, transparent 48%),
        radial-gradient(circle at var(--wear-scuff2-x, 72%) var(--wear-scuff2-y, 68%), rgba(40, 30, 20, 0.22) 0%, transparent 55%),
        linear-gradient(145deg, rgba(255, 255, 255, 0.14) 0%, transparent 42%),
        linear-gradient(215deg, rgba(40, 30, 20, 0.12) 0%, transparent 57%);
    mix-blend-mode: multiply;
    opacity: calc(var(--wear-layer-opacity, 1) * 0.65);
}

body[class*="deck-"]:not(.deck-red):not(.deck-blue):not(.deck-green):not(.deck-water):not(.deck-sun) .card:not(.hidden) {
    filter: sepia(0.35) saturate(0.8) brightness(0.92) contrast(0.9);
    box-shadow: inset 0 0 12px rgba(50, 35, 20, 0.5), 0 0 6px rgba(0, 0, 0, 0.25);
}

body[class*="deck-"]:not(.deck-red):not(.deck-blue):not(.deck-green):not(.deck-water):not(.deck-sun) .card:not(.hidden)::after {
    content: "";
    position: absolute;
    inset: 0;
    pointer-events: none;
    background:
        radial-gradient(circle at var(--wear-scuff-x, 24%) var(--wear-scuff-y, 24%), rgba(var(--wear-scuff-light-rgb, 255, 255, 255), 0.12) 0%, transparent 44%),
        radial-gradient(circle at var(--wear-scuff2-x, 70%) var(--wear-scuff2-y, 65%), rgba(var(--wear-scuff-dark-rgb, 30, 25, 20), 0.2) 0%, transparent 45%),
        linear-gradient(145deg, rgba(var(--wear-scuff-light-rgb, 255, 255, 255), 0.08) 0%, transparent 50%);
    mix-blend-mode: multiply;
    opacity: calc(var(--wear-layer-opacity, 1) * 0.45);
    z-index: 0;
}

body.deck-red .card.hidden::after,
body.deck-blue .card.hidden::after,
body.deck-green .card.hidden::after,
body.deck-water .card.hidden::after,
body.deck-sun .card.hidden::after {
    content: none;
}

/* Ink fade film (debug: apply to entire face for visibility). */
.card:not(.hidden) .ink-fade-layer {
    position: absolute;
    inset: 0;
    pointer-events: none;
    z-index: 3;
    opacity: calc(var(--wear-layer-opacity, 1) * var(--wear-fade-opacity, 1));
    background:
        radial-gradient(
            circle at var(--wear-ink-fade-x, 32%) var(--wear-ink-fade-y, 28%),
            rgba(var(--wear-grime-rgb, 220, 198, 165), var(--wear-ink-fade-alpha, 0.45)) 0%,
            rgba(var(--wear-grime-rgb, 220, 198, 165), 0) calc(var(--wear-ink-fade-size, 32%) * 1)
        ),
        radial-gradient(
            circle at var(--wear-ink-fade2-x, 70%) var(--wear-ink-fade2-y, 66%),
            rgba(var(--wear-grime-rgb, 220, 198, 165), var(--wear-ink-fade2-alpha, 0.4)) 0%,
            rgba(var(--wear-grime-rgb, 220, 198, 165), 0) calc(var(--wear-ink-fade2-size, 26%) * 1)
        ),
        linear-gradient(
            var(--wear-ink-fade-angle, 12deg),
            rgba(var(--wear-grime-rgb-2, 212, 189, 155), 0.5) 0%,
            rgba(var(--wear-grime-rgb-2, 212, 189, 155), 0) 55%
        );
    mix-blend-mode: normal;
}

body.deck-ghost .card:not(.hidden) {
    --wear-layer-opacity: 0.5;
}


/*
 * Face-card wear: only apply to compatible decks so we don't stomp
 * deck-specific face art (emoji, icons, custom faces).
 */
body.deck-red .card:not(.hidden),
body.deck-blue .card:not(.hidden),
body.deck-green .card:not(.hidden),
body.deck-water .card:not(.hidden),
body.deck-sun .card:not(.hidden) {
    background:
        radial-gradient(circle at var(--wear-scuff-x, 18%) var(--wear-scuff-y, 20%), rgba(255, 255, 255, 0.16) 0%, transparent 45%),
        radial-gradient(circle at var(--wear-scuff2-x, 75%) var(--wear-scuff2-y, 78%), rgba(120, 90, 60, 0.22) 0%, transparent 50%),
        linear-gradient(135deg, rgba(255, 255, 255, 0.12) 0%, transparent 45%),
        linear-gradient(135deg, #f3e6cd 0%, #e7d3b3 55%, #d7bea0 100%);
    border: 1px solid #b89f7a;
    color: #3a2a1d;
    box-shadow: inset 0 0 12px rgba(90, 70, 45, 0.28), 2px 2px 5px rgba(0, 0, 0, 0.4);
}

body.deck-red .card.red,
body.deck-blue .card.red,
body.deck-green .card.red,
body.deck-water .card.red,
body.deck-sun .card.red {
    color: rgba(140, 70, 60, 0.85);
}

body.deck-red .card.black,
body.deck-blue .card.black,
body.deck-green .card.black,
body.deck-water .card.black,
body.deck-sun .card.black {
    color: rgba(60, 50, 40, 0.85);
}

body .card {
    filter: saturate(0.82);
}

body.deck-sun .card {
    filter: saturate(0.68) brightness(0.96);
}

/* Water deck: mild water damage (warping + tide staining). */
body.deck-water .card {
    filter: saturate(0.88);
}

body.deck-water .card:not(.hidden)::after {
    content: "";
    position: absolute;
    inset: 0;
    pointer-events: none;
    border: 1px dashed rgba(60, 71, 100, 0.12);
    background:
        radial-gradient(circle at var(--wear-warp-x, 40%) var(--wear-warp-y, 60%),
            rgba(230, 245, 245, calc(var(--wear-warp-alpha, 0) * 0.55)) 0%,
            rgba(230, 245, 245, 0) 45%),
        linear-gradient(var(--wear-warp-angle, 25deg),
            rgba(180, 215, 220, calc(var(--wear-warp-alpha, 0) * 0.55)) 0%,
            rgba(180, 215, 220, 0) 32%),
        radial-gradient(circle at var(--wear-stain-x, 65%) var(--wear-stain-y, 35%),
            rgba(160, 195, 200, calc(var(--wear-stain-alpha, 0) * 0.7)) 0%,
            rgba(160, 195, 200, 0) 45%) !important;
    mix-blend-mode: multiply;
    opacity: calc(var(--wear-layer-opacity, 1) * 0.6);
}

body.deck-red .card:not(.hidden)::after,
body.deck-blue .card:not(.hidden)::after,
body.deck-green .card:not(.hidden)::after,
body.deck-sun .card:not(.hidden)::after {
    content: "";
    position: absolute;
    /* inset: 6px; */
    opacity: var(--wear-layer-opacity, 1);
    border: 1px dotted rgba(90, 70, 45, 0.12);
    background:
        linear-gradient(var(--wear-fold-angle, 35deg),
            rgba(255, 255, 255, var(--wear-fold-alpha, 0)) 0%,
            rgba(255, 255, 255, 0) 18%);
    background-position: var(--wear-fold-x, 12%) var(--wear-fold-y, 12%);
    background-repeat: no-repeat;
    pointer-events: none;
    mix-blend-mode: screen;
}

body.deck-red .card:not(.hidden)::before,
body.deck-blue .card:not(.hidden)::before,
body.deck-green .card:not(.hidden)::before,
body.deck-water .card:not(.hidden)::before,
body.deck-sun .card:not(.hidden)::before {
    content: "";
    position: absolute;
    inset: 0;
    opacity: var(--wear-layer-opacity, 1);
    background:
        radial-gradient(circle at var(--wear-stain-x, 60%) var(--wear-stain-y, 40%), rgba(120, 90, 60, calc(var(--wear-stain-alpha, 0) * 0.6)) 0%, transparent calc(var(--wear-stain-size, 24%) * 0.9)),
        radial-gradient(circle at var(--wear-stain-x, 60%) var(--wear-stain-y, 40%), rgba(70, 50, 35, calc(var(--wear-stain-alpha, 0) * 0.45)) 12%, transparent calc(var(--wear-stain-size, 24%) * 1.25)),
        radial-gradient(circle at var(--wear-graphite-x, 60%) var(--wear-graphite-y, 40%), rgba(60, 60, 60, var(--wear-graphite-alpha, 0)) 0%, transparent var(--wear-graphite-size, 28%)),
        radial-gradient(circle at var(--wear-dust-x, 30%) var(--wear-dust-y, 70%), rgba(255, 245, 225, var(--wear-dust-alpha, 0)) 0%, transparent var(--wear-dust-size, 45%)),
        radial-gradient(circle at var(--wear-nicotine-x, 65%) var(--wear-nicotine-y, 35%), rgba(200, 170, 110, var(--wear-nicotine-alpha, 0)) 0%, transparent var(--wear-nicotine-size, 36%)),
        radial-gradient(circle at var(--wear-matte-x, 55%) var(--wear-matte-y, 55%), rgba(240, 235, 220, var(--wear-matte-alpha, 0)) 0%, transparent var(--wear-matte-size, 32%)),
        linear-gradient(var(--wear-warp-angle, 25deg),
            rgba(255, 255, 255, var(--wear-warp-alpha, 0)) 0%,
            rgba(255, 255, 255, 0) 18%),
        linear-gradient(var(--wear-ink-angle, -20deg),
            rgba(45, 35, 30, var(--wear-ink-alpha, 0)) 0%,
            rgba(45, 35, 30, 0) 12%),
        linear-gradient(var(--wear-tear-angle, 10deg),
            rgba(40, 25, 18, 0.55) 0%,
            rgba(40, 25, 18, 0.55) 2%,
            rgba(255, 255, 255, 0.65) 3%,
            rgba(255, 255, 255, 0) var(--wear-tear-size, 32%)),
        linear-gradient(var(--wear-tear-angle, 10deg),
            rgba(255, 255, 255, 0.55) 0%,
            rgba(255, 255, 255, 0) 10%),
        linear-gradient(var(--wear-scratch-angle, 25deg),
            rgba(70, 50, 30, var(--wear-scratch-alpha, 0.12)) 0,
            rgba(70, 50, 30, var(--wear-scratch-alpha, 0.12)) 1px,
            transparent 2px),
        linear-gradient(var(--wear-scratch-angle-2, -30deg),
            rgba(255, 255, 255, 0.08) 0,
            rgba(255, 255, 255, 0.08) 1px,
            transparent 2px),
        radial-gradient(circle at 18% 22%, rgba(80, 60, 40, 0.22) 0%, transparent 42%),
        radial-gradient(circle at 65% 30%, rgba(120, 90, 60, 0.18) 0%, transparent 40%),
        radial-gradient(circle at 78% 80%, rgba(60, 45, 30, 0.24) 0%, transparent 48%),
        linear-gradient(115deg, rgba(255, 255, 255, 0.08) 0%, transparent 45%),
        linear-gradient(200deg, rgba(60, 45, 30, 0.12) 0%, transparent 55%);
    pointer-events: none;
    mix-blend-mode: multiply;
}
